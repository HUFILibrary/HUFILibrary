@using BLL_DAL;
@{
    Layout = null;
    VW_TINTUC item = (VW_TINTUC)ViewData["data"];
    List<LOAITINTUC> lstLoaiTinTuc = (List<LOAITINTUC>)ViewData["lstLoaiTinTuc"];
    VW_NHANVIEN nv = (VW_NHANVIEN)Session["AdminIsLogin"];
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang quản trị</title>
    <link rel="stylesheet" href="~/Content/css/reset.css">
    <link rel="stylesheet" href="~/Content/font/stylesheet.css">
    <link rel="stylesheet" href="~/Content/css/admin.css">
    <script src="~/Content/js/jquery-3.5.1.min.js"></script>
    <script src="~/Content/js/admin.js" defer></script>
    @*<script src="~/Content/js/lib/ckeditor.js"></script>*@
    <script src="~/Scripts/ckeditor/ckeditor.js"></script>
    <style type="text/css">
        #cke_contents_noidung{
            height:600px !important;
        }
        #cke_noidung .cke_mixed_dir_content {
            outline: none;
        }
    </style>
</head>
<body style="height:100%;">
    <div class="wrapper">
        <div class="left">
            <div class="left__wrapper">
                <div class="title">
                    <a href="#"><h2>TRANG QUẢN TRỊ</h2></a>
                </div>
                <div class="line"></div>
                <div class="row thongke">
                    <div class="row__parent">
                        <a href="#">Thống kê</a>

                    </div>
                </div>
                <div class="line"></div>
                <div class="row tintuc" id="tintuc">
                    <div class="row__parent">
                        <a href="#">Tin tức</a>
                        <div class="img">
                            <img src="~/Content/img/arrowAdminRight.svg" data-arrow="right" id="imgArrow" alt="">
                        </div>
                    </div>
                    <div id="tintuc__child" class="row__child">
                        <ul>
                            <li><a href="#">Thể loại tin tức</a></li>
                            <li><a href="@Url.Action("TinTuc","Admin")">Tin tức</a></li>
                        </ul>
                    </div>
                </div>
                <div class="line"></div>
                @*<div class="row tintuc" id="tintuc">
                        <div class="row__parent">
                            <a href="#">Tin tức</a>
                            <div class="img">
                                <img src="~/Content/img/arrowAdminRight.svg" data-arrow="right" id="imgArrow" alt="">
                            </div>
                        </div>
                        <div id="tintuc__child" class="row__child">
                            <ul>
                                <li><a href="#">Thể loại tin tức</a></li>
                                <li><a href="#">Tin tức</a></li>
                            </ul>
                        </div>
                    </div>*@
            </div>
        </div>
        <div class="right">
            <div class="header__wrapper">
                <div class="header">
                    <div class="account">
                        <div class="username">
                            <p>@nv.TenNhanVien</p>
                            <div class="img">
                                <img src="~/Content/img/profile.svg" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="main__wrapper">
                <div class="main thongtintintuc">
                    <div class="title">
                        <h2>Thông tin chi tiết</h2>
                    </div>
                    <div class="line"></div>
                    <div class="content">
                        @using (Html.BeginForm("SuaTinTuc", "Admin", FormMethod.Post, new { @id="formTT", enctype = "multipart/form-data" }))
                        {

                            <div class="row logo">
                                <div class="img">
                                    <img src="@Url.Content("~/Content/TinTuc/Logo/"+item.MaTinTuc.ToString()+"/" + item.Logo)" id="imgLogo" alt="">
                                </div>
                                <label class="chonlogo" for="logotintuc">Chọn hình</label>
                                <input type="file" name="logotintuc" id="logotintuc">
                                @*@Html.TextBox("logotintuc", "",new { type="file", id= "logotintuc" })*@
                            </div>
                            <div class="row">
                                <div class="col">
                                    <p>Mã: </p>
                                    <input type="text" value="@item.MaTinTuc" name="matintuc" readonly class="input readonly id">
                                </div>
                                <div class="col">
                                    <p>Loại tin tức: </p>
                                    <select class="input" name="loaitintuc" id="loaitintuc">
                                        @foreach (LOAITINTUC itemTT in lstLoaiTinTuc)
                                        {
                                            if (itemTT.MaLoaiTinTuc.ToString().Equals(item.MaLoaiTinTuc.ToString()))
                                            {
                                                <option selected value="@itemTT.MaLoaiTinTuc">@itemTT.TenMaLoaiTinTuc</option>
                                            }
                                            else
                                            {
                                                <option value="@itemTT.MaLoaiTinTuc">@itemTT.TenMaLoaiTinTuc</option>
                                            }
                                        }

                                    </select>
                                </div>
                            </div>
                            <div class="row textarea">
                                <div class="col">
                                    <p>Tiêu đề: </p>
                                    <textarea name="tieude" id="tieude" cols="30" rows="3" class="txtArea">@item.TieuDe</textarea>
                                </div>
                                <div class="col">
                                    <p>Mô tả ngắn: </p>
                                    <textarea name="motangan" id="motangan" cols="30" rows="3" class="txtArea">@item.MoTaNgan</textarea>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <p>Số lượt xem: </p>
                                    <input type="text" value="@item.SoLuongLuotXem" name="soluongluotxem" readonly class="input readonly views">
                                </div>
                                <div class="col">
                                    <p>Hiển thị: </p>
                                    @{
                                        if (item.HienThiTrangChu)
                                        {
                                            <input type="checkbox" name="hienthitrangchu" checked readonly class="chkbox">
                                        }
                                        else
                                        {
                                            <input type="checkbox" name="hienthitrangchu" readonly class="chkbox">
                                        }
                                    }
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <p>Ngày tạo: </p>
                                    @{
                                        string ngaytao = item.NgayTao == null ? "" : item.NgayTao.ToString();
                                        DateTime dngaytao = DateTime.Parse(item.NgayTao.ToString());
                                    }
                                    @Html.TextBox("ngaytao", item.NgayTao, "{0:yyyy-MM-dd}", new { @class = "input daycreate", @id = "datecreate", type = "date" })
                                    @*<input type="date" pattern="\d{1,2}/\d{1,2}/\d{4}" value="@dngaytao" placeholder="dd-mm-yyyy" id="datecreate" class="input daycreate">*@
                                </div>
                                <div class="col">
                                    <p>Người tạo: </p>
                                    <input type="text" value="@item.TenNhanVien" readonly class="readonly input creator">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col noidung">
                                    <p>Nội dung: </p>
                                    <textarea class="ckeditor" name="noidung" id="noidung" cols="80" rows="10">@item.NoiDung</textarea>
                                </div>
                            </div>
                            <div class="row controls">
                                <a type="submit" id="btnSubmit">Lưu</a>
                                <a href="@Url.Action("TinTuc","Admin")">Quay về</a>
                            </div>
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        document.getElementById('btnSubmit').addEventListener('click', function () {
            $('#formTT').submit();
        })
         ClassicEditor
		 .create( document.querySelector( '#noidung' ), {
             // toolbar: [ 'heading', '|', 'bold', 'italic', 'link' ]

		 } )
		 .then( editor => {
             window.editor = editor;

		 } )
		 .catch( err => {
		 	console.error( err.stack );
		 } );
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#imgLogo').attr('src', e.target.result);
                }

                reader.readAsDataURL(input.files[0]); // convert to base64 string
            }
        }

        $("#logotintuc").change(function () {
            readURL(this);
        });
    </script>
</body>
</html>

